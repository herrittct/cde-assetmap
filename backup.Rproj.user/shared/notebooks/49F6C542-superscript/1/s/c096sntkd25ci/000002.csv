"0","list.files(""./data/meal_count"", pattern = ""^SY"")"
"1","[1]"
"1"," ""SY10-11.xls"""
"1"," ""SY11-12.xls"""
"1"," ""SY12-13.xls"""
"1"," ""SY13-14.xls"""
"1"," ""SY14-15.xls"""
"1"," ""SY15-16.xls"""
"1"," ""SY16-17.xls"""
"1","
"
"1","[8]"
"1"," ""SY17-18.xls"""
"1","
"
"0","meal_count_directory <-  ""./data/meal_count/"""
"0","count_files <- list.files(""./data/meal_count"", pattern = ""^SY"")"
"0",""
"0","# creates a list of the matching files path"
"0","count_files <- paste0(meal_count_directory,count_files)"
"0",""
"0","# Creates list of with col_type = col_name, use names() to use the col_type"
"0","meal_count_column_unknown <- c(""text"" = ""sfa_num"","
"0","                               ""text"" = ""sfa_name"", "
"0","                               ""text"" = ""site_num"","
"0","                               ""text"" =""site_name"", "
"0","                               ""date""= ""claim_date"", "
"0","                               ""text"" =""meal_type"","
"0","                               ""text"" = ""earning_type"","
"0","                               ""text"" = ""rate_level"","
"0","                               ""text"" = ""provision"","
"0","                               ""numeric"" = ""count_days_served"", "
"0","                               ""numeric"" = ""free_meals_served"", "
"0","                               ""numeric"" = ""reduced_meals_served"", "
"0","                               ""numeric"" = ""paid_meals_served"", "
"0","                               ""numeric"" = ""total_meals_served"")"
"0",""
"0","# Imports all the files into a large list of lists"
"0","import_meal_count <-lapply(count_files, "
"0","                           read_excel,"
"0","                           range = ""a2:n50000"","
"0","                           col_names = meal_count_column_unknown,"
"0","                           col_types = names(meal_count_column_unknown)"
"0",")"
"0",""
"0","# Combines all the lists into a single dataframe, removes all the NAs "
"0","# created by the large loaded range from the excels"
"0","huge_meal_count <- bind_rows(import_meal_count) %>% "
"0","  filter(!is.na(sfa_num))"
"0",""
"0","# reduces working memory load by removing the imported dataframe"
"0","rm(""import_meal_count"", ""meal_count_column_unknown"","
"0","   ""meal_count_directory"", ""count_files"")"
"0",""
"0","# creates the sfa num format and site number needed for matching 0000"
"0","# creates the school year for the claim.  "
"0","district_meal_count <- mutate(huge_meal_count, "
"0","                              sfa_num_char = str_pad(sfa_num, width = 4, "
"0","                                                     side = ""left"", pad = ""0""),"
"0","                              site_num_char = str_pad(site_num, width = 4, "
"0","                                                      side = ""left"", pad = ""0""),"
"0","                              claim_year = year(claim_date),"
"0","                              claim_month = month(claim_date),"
"0","                              school_year = year(claim_date) + "
"0","                                (month(claim_date) <= 7),"
"0","                              meal_type = rename_meal_types(meal_type))"
"0",""
"0",""
"0","# remove and reorder a number of un-needed variables"
"0","district_meal_count <- select(district_meal_count, sfa_num_char, site_num_char, "
"0","                              school_year, meal_type,"
"0","                              everything(), -sfa_num, -site_num, "
"0","                              -earning_type, -claim_year)"
"0",""
